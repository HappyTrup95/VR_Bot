import telebot
from telebot import types
import pandas as pd
import VR_Bot_Zapch



def load_csv():
    return(pd.read_excel("user_table.xlsx"))

def user_PT(m):
    userid = m.from_user.id
    user_infor = load_csv()
    for i in range(len(user_infor)):
        if userid == user_infor.iloc[i]['ID']:
            bot.send_message (m.chat.id, f"Введите да если это актуальный номер {user_infor.iloc[i]['user_phone']}")
            markup = types.ReplyKeyboardMarkup(resize_keyboard= True)
            item1 = types.KeyboardButton("Да")
            item2 = types.KeyboardButton("Нет")
            markup.add(item1,item2)
        else:
            bot.send_message(m.chat.id,"Укажите свой номер телефона в формате +7 999 999 99 99")
    
            
def markup_functin(m):
    markup = types.ReplyKeyboardMarkup(resize_keyboard= True)
    item1 = types.KeyboardButton("Подбор запчастей")
    item2 = types.KeyboardButton("Автосервис")
    item3 = types.KeyboardButton("Кузовной ремонт")
    item4 = types.KeyboardButton("Автостраховка")
    item5 = types.KeyboardButton("Позвать оператора")

    markup.add(item1)
    markup.add(item2)
    markup.add(item3)
    markup.add(item4)
    markup.add(item5)

    bot.send_message(m.chat.id, 'Нажмите: \nКуда хотите перейти', reply_markup=markup)

#Подвәзываем скрипт к боту через токен
bot =telebot.TeleBot('5547286901:AAHQcefdvwh5KVALdNmjosBKPYLaYXjDpf0')

#Запускаем бота 
@bot.message_handler(commands=["start"])

#Начало действий бота создаем кнопки и сохраняем данные поп пользователю
def start(m,res=False):
    userid = m.from_user.id
    markup_functin(m)


@bot.message_handler(content_types=["text"])
def handler_text(m):
    if m.text.strip() == "Подбор запчастей":
        userid = m.from_user.id
        user_PT(m)
        

bot.polling(none_stop=True, interval=0)
